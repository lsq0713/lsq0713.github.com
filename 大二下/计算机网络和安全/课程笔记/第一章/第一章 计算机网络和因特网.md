# 第一章 计算机网络和因特网

## 1.1 什么是因特网

### 1.1.1 具体构成描述

> 从构成因特网的部件角度

**主机（host）/端系统（end system）：**

- 传统的桌面PC、Linux工作站及所谓的服务器
- 非传统的因特网物品，如智能手机、手表、眼镜、家用电器、运输控制系统等。

**通信链路（communication link）和分组交换机（packet switch）：**

> > 由不同的物理媒体组成，包括同轴电缆、铜线、光纤和无线电频谱

- **链路的传输速率：**比特/秒（bit/s，或bps）度量
- **分组：**当一台端系统要向另一台端系统发送数据时，发送端系统将数据分段，并为每段加上首部字节

> > > 分组交换机：从一条入通信链路接受到达的分组，并从它的一条出通信链路转发该分组

- **分组交换机的类型：**最著名的两种：*路由器（router）*和*链路层交换机（link-layer switch）*
- **路径（route或path）：**从发送端系统到接收端系统，一个分组所经历的一系列通信链路和分组交换机称为通过该网络的路径

- **因特网服务提供商（Internet Service Provider，ISP）：**端系统通过因特网服务提供商接入因特网，其本身就是一个由多台分组交换机和多段通信链路组成的网络
- **协议（protocol）：**端系统、分组交换机和其他互联网部件都要运行一系列协议，这些协议控制因特网中信息的接收和发送。其中最重要的两个协议为*TCP(Transmission Control Protocol，传输控制协议)*和*IP（Internet Protocol，网际协议）*。因特网的主要协议统称为TCP/IP
- **因特网标准（Internet Standard）：**由因特网工程任务组（Internet Engineering Task Force，IETF）研发
- **请求评论（Request For Comment，RFC）：**IETF的标准文档，最初只是普通的请求评论，因此得名

### 1.1.2 服务描述

> 从未应用程序提供服务的基础设施的角度

- **分布式应用程序：**涉及多个相互交换数据的端系统的应用程序
  - 既包括电子邮件和web等传统应用，还包括移动智能手机和平板电脑应用程序
  - 因特网应用程序运行在端系统上，并不运行在网络核心中的分组交换机中
- **套接字接口（socket interface）：**规定了运行在一个端系统上的程序请求因特网基础设施向运行在另一个端系统上的特定目的地程序交付数据的方式.是一套发送程序必须遵循的规则集合。（类比邮政服务中需要名称、地址、邮政编码并投入邮箱）

### 1.1.3 什么是协议

**人类活动的类比：**略

**网络协议：**协议（protocol）定义了在两个或多个通信实体之间交换的报文的格式和顺序，以及报文发送和/或接受一条报文或其他事件所采取的动作

## 1.2 网络边缘

 **端系统：**也称为主机（host），通常指与因特网相连的计算机和其他设备。包括桌面计算机、服务器、移动计算机，以及越来越多的非传统物品（物联网）。可进一步划分为两类：

> **客户（client）：**通常是桌面PC、移动PC和智能手机等
>
> **服务器（server）：**通常是更为强大的机器，用于存储和发布Web页面、流视频、中继电子邮件等

### 1.2.1 接入网

- **接入网：**指将端系统物理连接到其*边缘路由器（edge  server）*的网络，边缘路由器是端系统到任何其他远程端系统的路径上的第一台路由器

**家庭接入：DSL、电缆、FTTH、拨号和卫星**

宽带住宅接入有两种最流行的类型：*数字用户线*和电缆

- **数字用户线（Digital Subscriber Line，DSL）**
- **电缆**
- **光纤到户(Fiber To The Home，FTTH)**
- **拨号**
- **卫星**

**企业（和家庭）接入：以太网和wifi** 

**广域无线接入：3G和LTE**                                                                                                                                                                                                                                                                                                                                

### 1.2.2 物理媒体

分为导引型媒体和非导引型媒体

- **双绞铜线：**无屏蔽双绞线(UnshieldedTwisted Pair, UTP)，高速LAN联网的主导性解决方案

- **同轴电缆：**常被用作导引型**共享媒体(shared medium)**

- **光纤：**长途导引型传输媒体，由于高成本的光设备阻碍其在短途中的应用。光载波（Optical Carrier，OC）标准链路

- **陆地无线电信道：**分为三类：很短距离（1-2米），局域（数十或几百米），广域（数万米）

- **卫星无线电信道：**一个卫星以及位于地面上的数个发射器/接收器

## 1.3 网络核心

### 1.3.1 分组交换

- **报文（message）：**在各种网络应用中，端系统互相交换报文，报文能够包含协议设计者需要的任何东西
- **分组（package）：**源将长报文分为较小的数据块，称为分组
- **分组交换机（package switch）：**在源和目的地之间，分组通过数据链路和分组交换机传输。交换机主要有两类：*路由器（router）*和*链路层交换机（link-layer switch）*
  - 存储转发传输：交换机在输出一个分组的第一个比特之前，必须先完整的接受到整个分组
  - 排队时延和分组丢失：分组交换机对于每条与之相连的链路都有一个*输出缓存(output buffer)*, 也称为*输出队列(output queue)*，当缓存已经被充满时，若再接收到分组，会发生*分组丢失（丢包）（package loss）*
  - 转发表和路由选择协议：每个端系统具有一个成为IP地址的地址，该地址是一个等级结构。*转发表（forwarding table）*将目的地址映射成为输出链路。

### 1.3.2 电路交换

在电路交换网络中，在端系统通信会话期间，预留了端系统间沿路径通信所需要的资源（缓存，链路传输速率）。该连接称为一条*电路（circuit）*

- 电路交换网络中的复用
  - **频分复用（Frequency-Division Multiplexing，FDM）：**链路的频谱由跨越链路创建的所有连接共享。频段的宽度称为*带宽（band-width）*
  - **时分复用（Time-Division Multiplexing，TDM）：**时间被分为固定间隙的帧，每个帧又被分为固定数量的时隙。建立连接时，在每个帧中为该连接指定一个时隙。
- 分组交换与电路交换的对比
  - 分组交换的端到端时延是可变的和不可预测的
  - 分组交换比电路交换有更好的带宽共享，更简单、更有效、实现成本更低

### 1.3.3 网络的网络

- **存在点（Point of Presence，PoP）：**存在于等级结构中除底层等级（接入ISP）外的所有层次。一个PoP只是服务商网络中一台或多台（在相同位置）群组，其中客户ISP能够与提供商ISP连接。
- **多宿（multi-home）：**任何ISP（除了第一层ISP）可以与两个或更多提供商ISP连接
- **对等（peer）：**位于相同等级结构层次的邻近一对ISP能够直接将它们的网络连到一起，使它们之间的所有流矗经直接连接而不是通过上游的中间ISP传输。当两个ISP对等时，通常不进行结算，即任一个ISP不向其对等付费。第一层JSP也与另一个第一层ISP对等．它们之间无结算。
- **因特网交换点（Internet Exchange Point，IXP）：**IXP是一个汇合点，多个ISP能够在这里一起对等。IXP通常位于一个有自己的交换机的独立建筑物中
- **内容提供商网络（content provider network）：**如谷歌的数据中心等

## 1.4 分组交换网中的时延、丢包和吞吐量

### 1.4.1 分组交换网中的时延概述

- **节点处理时延(nodal processing delay)：**检查分组首部和决定将该分组导向何处所需要的时间是处理时延的一部分。处理时延也能够包括其他因素，如检查比特级别的差错所需要的时间，该差错出现在从上游节点向路由器A传输这些分组比特的过程中。
- **排队时延(queuing delay)：**分组在链路上等待传输时所需要的时间，一个特定分组的排队时延长度将取决于先期到达的正在排队等待向链路传输的分组数量。如果该队列是空的，并且当前没有其他分组正在传输，则该分组的排队时延为0。
- **传输时延( transmission delay)：**假定分组以*先到先服务*方式传输（仅当所有已经到达的分组被传输后，才能传输刚到达的分组）。分组长度为L比特，速率为R bps，则传输时延为L/R
- **传播时延(propagationdelay)：**一旦一个比特被推向链路，该比特需要向路由器B传播。从该链路的起点到路由器B传播所需要的时间是传播时延。该比特以该链路的传播速率传播己该传播速率取决于该链路的物理媒体（即光纤、双绞铜线等）
- **节点总时延(totalnodal delay )：**以上时延的总和

### 1.4.2 排队时延和丢包

- **流量强度（traffic intensity）：**a表示分组到达速率（分组/秒，pkt/s），每个分组长度为L（比特，bit），可得比特的速率为La（bps，即b/s，比特每秒），传输速率R（bps），则称La/R为流量强度
- **丢包：**当队列已满时，若有新的分组到达，由千没有地方存储这个分组，路由器将丢弃(drop)该分组，即该分组将会丢失(lost)

### 1.4.3 端到端时延

- **端到端时延：**假设一网络是无拥塞的（排队时延微不足道），在源主机和目的主机之间有N-1台路由器，则端到端时延：

$$
d_{end-end}=N(d_{proc}+d_{trans}+d_{prop})\tag{1}
$$

- **端系统、应用程序和其他时延：**希望向共享媒体（例如在WiFi或电缆调制解调器情况下）传输分组的端系统可能有意地延迟它的传输，把这作为它与其他端系统共享媒体的协议的一部分；另一个重要的时延是媒体分组化时延，这种时延出现在IP语音(VoIP)应用中。在VoIP中，发送方在向因特网传递分组之前必须首先用编码的数字化语音填充一个分组。这种填充一个分组的时间称为分组化时延．它可能较大，并能够影响用户感受到的VoIP呼叫的质量。

### 1.4.4 计算机网络中的吞吐量

- **瞬时吞吐量（instantaneous throughput）与平均吞吐量(average throughput)：**接收到F比特用去了T秒，则平均吞吐量为F/T bps
- **瓶颈链路( bottleneck link)：**一条链路的吞吐取决于链路上较低的带宽，同时也受到干扰流量的影响，在有许多其他的数据流也通过这条链路流动时，一条具有高传输速率的链路仍然可能成为文件传输的瓶颈链路

## 1.5 协议层次及其服务模型

### 1.5.1 分层的体系结构

- **协议分层：**网络设计者以*分层(layer)*的方式组织协议以及实现这些协议的网络硬件和软件。每个协议属于这些层次之一，就像图1-22所示的航线体系结构中的每种功能属于某一层一样。我们再次关注某层向它的上一层提供的服务(service), 即所谓一层的*服务模型(service model)*。
- **协议栈（protocol stack）：**各层的所有协议成为协议栈

因特网的协议栈有五层组成：物理层、链路层、链路层、网络层、传输层和应用层

| 应用层 |
| :----: |
| 传输层 |
| 网络层 |
| 链路层 |
| 物理层 |

1. **应用层：**应用层是网络应用程序及它们的应用层协
   议存留的地方。因特网的应用层包括许多协
   议，例如HTTP(它提供了W~b文档的请求和
   传送）、SMTP(它提供了电子邮件报文的传
   输）和FTP(它提供两个端系统之间的文件传
   送）。
2. **传输层：**

## 1.6 面对攻击的网络

互联网三大主流理念：开放、共享、匿名

- 数据包拦截（嗅探sniff）：
- IP欺骗：注入带有虚假源地址的数据包
- Denial of Service（DoS）：

防御方法：身份验证、保密性、完整性检查、访问限制、防火墙

